# Junit2Avalla
[![Static Badge](https://img.shields.io/badge/asmeta-main_repository-black?style=social&logo=github&link=https%3A%2F%2Fgithub.com%2Fasmeta%2Fasmeta)](https://github.com/asmeta/asmeta)
[![Junit2Avalla - Build and Push CI Pipeline](https://github.com/asmeta/asmeta/actions/workflows/junit2avalla_pipeline.yml/badge.svg)](https://github.com/asmeta/asmeta/actions/workflows/junit2avalla_pipeline.yml)

## Project Overview

**Junit2Avalla**  is a tool that allows you to automatically convert a Junit test scenarios into Avalla scenarios with the aim of simplifying the testing procedure of an Abstract State Machine (ASM).

## How to start

### Using Maven

If you prefer to run the application directly using Maven, make sure you have installed:

  - Java 8+
  - Maven 3+

and follow these steps:

1. Open PowerShell or your preferred terminal and clone the repository using a password-protected SSH key:
    ```shell
    git clone git@github.com:asmeta/asmeta.git
    ```

2. Navigate into the project directory:
    ```shell
    cd ./code/experimental/junit2avalla
    ```

3. Build the Project:
   ```shell
   mvn clean package
   ```

4. Run the Application:
   ```shell
   java -jar ./dist/junit2avalla.jar -help
   ```

5. Customize execution with additional options:
   ```shell
   java -jar ./dist/junit2avalla.jar -input <input> -output <output> -clean
   ```

    - `-input` : The ASM input file (required).

    - `-output` : The output folder (optional, defaults to `./output/`).

    - `-clean` : Delete the files used by the translator in the input folder.
      
    - `-help` : Displays a help message describing all available options.

6. Example of a use case:
   ```shell
   java -jar .\dist\junit2avalla.jar -input "input/RegistroDiCassav4_ATG_ESTest.java" -clean
   ```

### Using Docker

While if you prefer to use Docker make sure you have installed and opened Docker desktop, then follow these steps:

1. Open Docker Desktop and pull the Docker image:
    ```shell
    docker pull isaacmaffeis/junit2avalla:latest
    ```

2. Mount the volumes and run:
    ```shell
    docker run --rm -v "$(pwd)/<input>:/app/input" -v "$(pwd)/<output>:/app/output" isaacmaffeis/junit2avalla -input <input> -output <output> -clean
    ```

    - `-v "$(pwd)/<input>:/app/input"` : Maps the input file from the host to the container (required)

    - `-v "$(pwd)/<output>:/app/output"` : Maps the output folder from the host to the container (required)

3. Example of a use case:
   Copy the junit example file `RegistroDiCassav4_ATG_ESTest.java` into the `input` directory, 
   then, inside the `./junit2avalla` folder, run:
    ```shell
     docker run --rm -v "$(pwd)/input:/app/input" -v "$(pwd)/output:/app/output" isaacmaffeis/junit2avalla -clean
    ```

## Usage

After building the project, you can use it with the following command-line options:

### Command-Line Options

| Option             | Argument Type     | Description                                                                 |
|--------------------|-------------------|-----------------------------------------------------------------------------|
| `-help`            | None              | Prints the help message with a description of available options.            |
| `-input`           | String (required) | Path to the Java input file.                                                |
| `-output`          | String (optional) | Specifies the output folder. Defaults to `./output/`.                       |
| `-clean`           | | Cleans the input and stepFunctionArgs files after the process.              |

## Repository Structure
The project repository is organized into the following folders:

- `input/`: The application expects .java input files to be placed here before execution.

- `output/`: The output .avalla files generated by the services will be located here.

- `src/`: The main source code of the project.

- `generated-sources/antlr4`: Contains all the files automatically generated by antlr to parse the scenarios.
